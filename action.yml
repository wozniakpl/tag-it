name: 'Tag It'
description: 'Validates Conventional Commits on PRs and auto-generates semantic version tags on push to main'
author: 'wozniakpl'

branding:
  icon: 'tag'
  color: 'blue'

inputs:
  github-token:
    description: 'GitHub token for API access'
    required: true
    default: ${{ github.token }}
  tag-prefix:
    description: 'Prefix for version tags (e.g., "v")'
    required: false
    default: 'v'
  initial-version:
    description: 'Initial version if no tags exist'
    required: false
    default: '0.0.0'
  floating-tag:
    description: 'Floating tags mode: "true" (default) updates major tag (e.g., v5). Set to "minor" to also update minor tag (e.g., v5.2). Set to "false" to disable.'
    required: false
    default: 'true'
  create-release:
    description: 'Create or update a GitHub Release for the new tag with generated release notes'
    required: false
    default: 'false'
  pre-release-command:
    description: 'Optional shell command to run before creating the tag (e.g. bump version in Cargo.toml). If it produces file changes, they are committed and pushed, then the tag is created on that commit. Env: NEW_VERSION, NEW_TAG. Default: not set (no extra commit).'
    required: false
    default: ''

outputs:
  new-tag:
    description: 'The new tag that was created (only on push events)'
  bump-type:
    description: 'The type of version bump (major, minor, patch, or none)'
  floating-tag:
    description: 'The floating major version tag that was updated (e.g., v5)'
  floating-minor-tag:
    description: 'The floating minor version tag that was updated (e.g., v5.2)'
  release-url:
    description: 'The GitHub Release URL that was created/updated (only when create-release is enabled)'

runs:
  using: 'node20'
  main: 'dist/index.js'
